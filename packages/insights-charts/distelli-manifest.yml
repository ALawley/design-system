insights/insights-charts:
  PreBuild:
    - sudo add-apt-repository ppa:git-core/ppa
    - sudo apt-get update
    - sudo apt-get install git
    - nvm install v8.11.3
    - nvm alias default v8.11.3
    - nvm use default
    - touch $HOME/.npmrc
    - echo -e "//registry.npmjs.org/:_authToken=$NPM_REGISTRY_AUTH\n@puppet:registry=https://artifactory.delivery.puppetlabs.net/artifactory/api/npm/npm__local/\n//artifactory.delivery.puppetlabs.net/artifactory/api/npm/npm__local/:_authToken=$ARTIFACTORY_REGISTRY_AUTH" > $HOME/.npmrc
  Build:
    - echo "---Build Started---"
    - make setup
    - npm run js-lint
    - npm run scss-lint
    - npm run test
    - echo "---Build Finished---"
  AfterBuildSuccess:
    - ./scripts/release-if-master.sh
